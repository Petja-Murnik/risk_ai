% Input common header
\input{../ai_for_risk_header}


\title{Graphical Models for Risk}
\begin{document}
\maketitle

\begin{frame}
\frametitle{Graphs}

\emph{Definition} A \emph{directed acyclical graph} or \emph{DAG} is ??? \newline

\emph{Definition} A \emph{path} in a DAG $G$ is a consecutive set of edges, independent of directions. \newline

\end{frame}

\begin{frame}
\frametitle{d-separation}
\emph{Definition} Let $X$, $Y$, and $Z$ be three disjoint subsets of nodes in a directed acyclic graph, $G$, and let $p$ be any path betweeen a node in $X$ and one in $Y$, where by `path'we mean a succession of arcs, independent of direction. Then $Z$ is said to block $p$ if there is a node $w$ on $p$ satisfying one of the following two conditions

\begin{enumerate}
\item $w$ has converging arrows along $p$, and neither $w$ nor any of its descendents are in $Z$, or
\item $w$ does not have converging arrows along $p$, and $w$ is in $Z$.
\end{enumerate}

Further, $Z$ is said to $d-separate$ $X$ from $Y$ in $G$, denoted 

\begin{equation*}
    (X \ci Y | Z)_G
\end{equation*}

if and only if $Z$ blocks every path from a node in $X$ to a node in $Y$.\newline

References: \cite{pearl1995causal}
\end{frame}


\begin{frame}
\frametitle{d-separation}
\framesubtitle{Intuition}
From \cite{scheines-tutorial}: \newline

\begin{quote}
Roughly, two variables $X$ and $Y$ are independent conditional on $Z$ if knowledge of $X$ gives you no extra information about $Y$ once you have knowledge about $Z$. In other words, once you know $Z$, $X$ adds nothing to what you know about $Y$.
\end{quote}

\end{frame}

\begin{frame}
    \frametitle{d-separation}
    \framesubtitle{Alternative definition via blocking paths}
    
 
\end{frame}

\begin{frame}
    \frametitle{d-separation}
    \framesubtitle{Alternative definition, ii}

    Let $A$, $B$, $C$ be non-intersecting subsets of vertices of a DAG $G$. \newline

    \emph{Definition} A path from $A$ to $B$ is \emph{blocked} by $C$ if the path contains a node such that either

    \begin{itemize}
    \item the node is in $C$, and the arrows on the path at the node meet either head-to-tail or tail-to-tail, or
    \item neither the node nor its descendents is in $C$, and the arrows on the path at the node meet head-to-head \newline
    \end{itemize}

    \emph{Definition} A is said to be $d-separated$ from $B$ by $C$ if all paths from $A$ to $B$ are blocked by $C$. We write

    \begin{equation*}
        (A \ci B | C)
    \end{equation*}

    References: \cite{tum-graphical}

    
\end{frame}


\begin{frame}
    \frametitle{d-separation}
    \framesubtitle{Examples}

    \begin{figure}[ht]
        \begin{center}
          \begin{tabular}{cc}
            \onslide<2->{$(A \ci B | \, \{c\})$}
            \begin{tikzpicture}
                                % Define nodes
                \node[obs]                               (c) {$c$};
                \node[obs, above=of c, xshift=-1.2cm] (a) {$a$};
                \node[obs, above=of c, xshift=1.2cm]  (b) {$b$};
        
                \edge {a} {c} ; %
                \edge {c} {b} ;
              
              \end{tikzpicture} &
              \onslide<2->{$(A \ci B | \, \{c\})$}
              \begin{tikzpicture}

                % Define nodes
                \node[obs]                               (c) {$c$};
                \node[obs, above=of c, xshift=-1.2cm] (a) {$a$};
                \node[obs, above=of c, xshift=1.2cm]  (b) {$b$};
        
                \edge {b} {c} ; %
                \edge {c} {a} ; %
              
              \end{tikzpicture}
          \end{tabular}
          \begin{tabular}{cc}
            \onslide<2->{$(A \ci B | \, \{c\}))$}
            \begin{tikzpicture}
                                % Define nodes
                \node[obs]                               (c) {$c$};
                \node[obs, above=of c, xshift=-1.2cm] (a) {$a$};
                \node[obs, above=of c, xshift=1.2cm]  (b) {$b$};
        
                \edge {c} {a} ; %
                \edge {c} {b} ;
              
              \end{tikzpicture} &
              \onslide<2->{$(A \ci B | \,\emptyset)$}
              \begin{tikzpicture}

                % Define nodes
                \node[obs]                               (c) {$c$};
                \node[obs, above=of c, xshift=-1.2cm] (a) {$a$};
                \node[obs, above=of c, xshift=1.2cm]  (b) {$b$};
        
                \edge {a} {c} ; %
                \edge {b} {c} ; %
              
              \end{tikzpicture}
          \end{tabular}
        \end{center}
        \caption{Examples $A = \{a\}$, $B = \{ b\}$.}
      \end{figure}

\end{frame}

\begin{frame}
    \frametitle{d-separation}
    \framesubtitle{More examples}

    \begin{figure}[ht]
        \begin{center}
          \begin{tabular}{cc}
            \onslide<2->{$\neg (A \ci B | \, \{c\})$, but $(A \ci B | \, \emptyset)$}
            \begin{tikzpicture}
                                % Define nodes
                \node[obs]                               (d) {$d$};
                \node[obs, left=of d, xshift=-1.2cm] (a) {$a$};
                \node[obs, right=of d, xshift=1.2cm]  (b) {$b$};
                \node[obs, below=of d]                (c) {$c$};
                \edge {a} {d} ; %
                \edge {b} {d} ;
                \edge {c} {a} ;
                \edge {c} {b} ;
              
              \end{tikzpicture} &
              
        %       \onslide<2->{$(A \ci B | \, \{c\})$}
        %       \begin{tikzpicture}

        %         % Define nodes
        %         \node[obs]                               (c) {$c$};
        %         \node[obs, above=of c, xshift=-1.2cm] (a) {$a$};
        %         \node[obs, above=of c, xshift=1.2cm]  (b) {$b$};
        
        %         \edge {b} {c} ; %
        %         \edge {c} {a} ; %
              
        %       \end{tikzpicture}
        %   \end{tabular}
        %   \begin{tabular}{cc}
        %     \onslide<2->{$(A \ci B | \, \{c\}))$}
        %     \begin{tikzpicture}
        %                         % Define nodes
        %         \node[obs]                               (c) {$c$};
        %         \node[obs, above=of c, xshift=-1.2cm] (a) {$a$};
        %         \node[obs, above=of c, xshift=1.2cm]  (b) {$b$};
        
        %         \edge {c} {a} ; %
        %         \edge {c} {b} ;
              
        %       \end{tikzpicture} &
        %       \onslide<2->{$(A \ci B | \,\emptyset)$}
        %       \begin{tikzpicture}

        %         % Define nodes
        %         \node[obs]                               (c) {$c$};
        %         \node[obs, above=of c, xshift=-1.2cm] (a) {$a$};
        %         \node[obs, above=of c, xshift=1.2cm]  (b) {$b$};
        
        %         \edge {a} {c} ; %
        %         \edge {b} {c} ; %
              
        %      \end{tikzpicture}
          \end{tabular}
        \end{center}
        \caption{Examples $A = \{a\}$, $B = \{ b\}$.}
      \end{figure}

\end{frame}

\begin{frame}[allowframebreaks]
    \frametitle{References}
    \bibliographystyle{amsalpha}
    \bibliography{../../references.bib}
\end{frame}

\end{document}